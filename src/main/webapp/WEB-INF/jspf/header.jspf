<%--=========================================================================== 
Header (top area). 
===========================================================================--%>
<%@ include file="/WEB-INF/jspf/directive/page.jspf" %>
<%@ include file="/WEB-INF/jspf/directive/taglib.jspf" %>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <%--    <a class="navbar-brand" href="#">Navbar</a>--%>
    <%--    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">--%>
    <%--        <span class="navbar-toggler-icon"></span>--%>
    <%--    </button>--%>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active" id="home">
                <fmt:message key="header.jspf.button.home" var="home"/>
                <a class="nav-link" id="home_page" href="<c:url value="/home"/>"><c:out value="${home}"/></a>
            </li>
            <li class="nav-item" id="about">
                <a class="nav-link" href="#about"><fmt:message key="header.jspf.button.about"/></a>
            </li>
            <li class="nav-item" id="calcCoast">
                <a class="nav-link" href="<c:url value="/calculate_coast"/>">
                    <fmt:message key="header.jspf.button.calc_coast"/></a>
            </li>
            <c:if test="${role.getName() eq 'client'}">
                <li class="nav-item" id="createOrder">
                    <fmt:message key="header.jspf.button.create_order" var="create_order"/>
                    <a class="nav-link" href="<c:url value="/controller?command=viewCreateOrderPage"/>">
                        <c:out value="${create_order}"/></a>
                </li>
            </c:if>
        </ul>
        <c:choose>
            <c:when test="${empty user}">
                <form class="form-inline my-2 my-lg-0" action="<c:url value="/controller"/>" method="post">
                    <input type="hidden" name="command" value="login"/>
                    <fmt:message key="header.jspf.input.username" var="userName"/>
                    <input class="form-control" type="text" placeholder="${userName}" name="login" required>
                    <fmt:message key="header.jspf.input.password" var="pass"/>
                    <input class="form-control" id="psw" type="password" placeholder="${pass}" name="password"
                           required>
                    <button class="btn btn-primary" type="submit"><fmt:message
                            key="header.jspf.button.login"/></button>
                    <button class="btn btn-outline-success my-2 my-sm-0" id="register_button" type="button"
                            onclick="window.location.href='/controller?command=viewRegistrationPage'">
                        <fmt:message key="header.jspf.button.register"/></button>
                </form>
            </c:when>
            <c:when test="${not empty user}">
                <c:choose>
                    <c:when test="${role.getName() eq 'client'}">
                        <div class="btn-group dropleft">
                            <button type="button" class="btn btn-light dropdown-toggle" data-toggle="dropdown"
                                    aria-haspopup="true" aria-expanded="false">
                                <c:out value="${user.getLogin()}"/></button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="<c:url value="/controller?command=clientCabinet"/>">
                                    <fmt:message key="header.jspf.button.my_orders"/></a>
                                <a class="dropdown-item" href="<c:url value="/controller?command=clientViewInvoices"/>">
                                    <fmt:message key="header.jspf.button.my_invoices"/></a>
                                <a class="dropdown-item" href="<c:url value="/client_page.jsp"/>">
                                    <fmt:message key="header.jspf.button.user_details"/>
                                </a>
                            </div>
                        </div>
                    </c:when>
                    <c:when test="${role.getName() eq 'admin'}">
                        <button type="button" onclick="window.location.href='/controller?command=adminCabinet'"
                                class="btn btn-light"><c:out value="${user.getLogin()}"/></button>
                    </c:when>
                </c:choose>
                <button type="button" class="btn btn-danger"
                        onclick="window.location.href='/controller?command=logout'">
                    <fmt:message key="header.jspf.button.logout"/>
                </button>
            </c:when>
        </c:choose>
    </div>
    <script>
        function navbarFunction() {
            const home = document.getElementById('home');
            const about = document.getElementById('about');
            const calcCoast = document.getElementById('calcCoast');
            const createOrder = document.getElementById('createOrder');
            if (window.location.href === '/home') {
                home.classList.add('active');
                about.classList.remove('active');
                calcCoast.classList.remove('active');
                createOrder.classList.remove('active');
            }else if (window.location.href === 'about'){
                home.classList.remove('active');
                about.classList.add('active');
                calcCoast.classList.remove('active');
                createOrder.classList.remove('active');
            }else if (window.location.href === '/calculate_coast'){
                home.classList.remove('active');
                about.classList.remove('active');
                calcCoast.classList.add('active');
                createOrder.classList.remove('active');
            }else if (window.location.href === '/create_order'){
                home.classList.remove('active');
                about.classList.remove('active');
                calcCoast.classList.remove('active');
                createOrder.classList.add('active');
            }
        }
    </script>
</nav>